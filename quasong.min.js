$(document).ready(function() {
    var m;
    var f;
    var i;
    var b;
    var d;
    $(".start").bind("click", c);
    $(".go").bind("click", g);
    $(".more").bind("click", j);
    $(".reload").bind("click", a);
  
  
    o();
    function o() {
        m = "R";
        for (var p = 1; p <= 3; p++) {
            var q = new l("wolf");
            q.land()
        }
        for (var p = 1; p <= 3; p++) {
            var r = new l("sheep");
            r.land()
        }
    }
    function l(s) {
        var v = $("<div></div>").addClass(s);
        v.bind("click", r);
        this.land = p;
        this.boat = u;
        function r() {
            var w = ($(this).parents(".L").size() == 1 ? "L" : "R");
            var y = ($(this).parents(".boat").size() == 1);
            var z = ($(this).parents(".land").size() == 1);
            if (z && w != m) {
                return
            }
            if (y) {
                p()
            } else {
                if (q() < 2) {
                    u()
                }
            }
            if (q() == 0) {
                $(".go").hide()
            }
            if (q() > 0) {
                $(".go").show()
            }
            if (m == "L" && t() == 6) {
                try {
                    document.getElementById("bgmusic").pause();
                    document.getElementById("smusic").play()
                } catch (x) {}
                setTimeout(n, 1000)
            }
        }
        function q() {
            return $(".boat .wolf, .boat .sheep").size()
        }
        function t() {
            return $(".land." + m + " .wolf, .land." + m + " .sheep").size()
        }
        function u() {
            var w = $(".boat .seat:empty:first");
            w.append(v)
        }
        function p() {
            var w = $(".land." + m + " .line_" + s + ":empty:first");
            w.append(v)
        }
    }
    function g() {
        var p = true;
        var r = $(".land." + m + " .wolf").size();
        var s = $(".land." + m + " .sheep").size();
        if (s != 0 && r > s) {
            p = false
        }
        var q, t;
        if (m == "L") {
            q = {
                left: 160
            };
            t = "R"
        } else {
            q = {
                left: 0
            };
            t = "L"
        }
        m = "onTheWay";
        $(".boat").animate(q, "normal", "swing", function() {
            m = t;
            var v = $(".land." + m + " .wolf, .boat .wolf").size();
            var w = $(".land." + m + " .sheep, .boat .sheep").size();
            if (w != 0 && v > w) {
                p = false
            }
            if (!p) {
                try {
                    document.getElementById("bgmusic").pause();
                    document.getElementById("emusic").play()
                } catch (u) {}
                setTimeout(e, 1000)
            }
        })
    }
    function e() {
        clearInterval(d);
        $(".mask").show();
        $(".go").hide();
        $(".failure").show();

        $(".reload").show()
    }
    function n() {
        try {
            document.getElementById("bgmusic").pause();
            document.getElementById("smusic").play()
        } catch (p) {}
        clearInterval(d);
        $(".mask").show();
        $(".go").hide();
        $(".time").hide();
        $(".success").show();
        $(".more").css("left", 150).css("top", 270).show();
        $(".reload").show()
    }
    function c() {
        $(".mask").hide();
        $(".welcome").hide();
        $(".start").hide();
        $(".more").hide();
        $(".time").show();
        f = new Date();
        d = setInterval(function() {
            i = new Date() - f;
            var q = parseInt(i / 1000 / 60);
            var r = (i / 1000) % 60;
            b = (q > 0 ? q + "P" : "") + r.toFixed(2) + "S";
            $(".time").text("Thời Gian：" + b)
        }, 25);
        try {
            document.getElementById("bgmusic").play()
        } catch (p) {}
    }
    function a() {
        $(".success").hide();
        $(".failure").hide();
        $(".reload").hide();
        $(".help").hide();

        $(".time").text("").hide();
        $(".result").text("").hide();
        $(".boat").css("left", 160);
        $(".welcome").show();
        $(".start").show();
        $(".more").css("left", 80).css("top", 250).show();
        $(".wolf, .sheep").remove();
        o();
        c();
        try {
            document.getElementById("bgmusic").play()
        } catch (p) {}
    }
    function j() {
        clickMore()
    }
   
    function k() {
        dp_share()
    }
});
